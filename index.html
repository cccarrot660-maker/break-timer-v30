<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Break Timer V11 PRO — break</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>

<!-- SVG sprite: feather-like minimal icons -->
<svg aria-hidden="true" style="position:absolute;width:0;height:0;overflow:hidden" xmlns="http://www.w3.org/2000/svg">
  <symbol id="icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round">
    <rect x="3" y="4" width="18" height="18" rx="2"></rect>
    <path d="M16 2v4M8 2v4M3 10h18"></path>
  </symbol>
  <symbol id="icon-tag" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round">
    <path d="M20 12v6a2 2 0 0 1-2 2H10L4 12l6-8h8a2 2 0 0 1 2 2v6z"></path>
  </symbol>
  <symbol id="icon-note" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 15V6a2 2 0 0 0-2-2H7L3 8v9a2 2 0 0 0 2 2h11"></path>
    <path d="M7 10h8M7 14h5"></path>
  </symbol>
  <symbol id="icon-check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M20 6L9 17l-5-5"></path>
  </symbol>
</svg>

  <header class="topbar">
    <div class="brand">
      <h1>NOAH345</h1>
      <div class="subtitle">Break Timer — Neon CyberUI</div>
    </div>
    <nav class="nav">
      <button id="darkToggle" class="btn ghost">โหมดมืด</button>
      <button id="openProfile" class="btn ghost">โปรไฟล์</button>
    </nav>
  
  
  






  <!-- Theme Preset Full-Width Scroll Bar (NOAH345) -->
  <div class="theme-switcher fullwidth" aria-label="Theme presets fullwidth">
    <div class="fullwidth-inner">
      <div class="fullwidth-grid" role="list" aria-label="Theme presets">
        <!-- icons: maintain same order as available themes -->
        <button class="fw-item theme-btn" data-theme="purple" title="Purple">💜</button>
        <button class="fw-item theme-btn" data-theme="cyan" title="Cyan">💠</button>
        <button class="fw-item theme-btn" data-theme="pink" title="Pink">🌸</button>
        <button class="fw-item theme-btn" data-theme="pastel" title="Pastel">🫧</button>

        <button class="fw-item theme-btn" data-theme="violetpulse" title="Violet Pulse">💜</button>
        <button class="fw-item theme-btn" data-theme="aquawave" title="Aqua Wave">💠</button>
        <button class="fw-item theme-btn" data-theme="pinksonic" title="Pink Sonic">🌸</button>
        <button class="fw-item theme-btn" data-theme="cyberlime" title="Cyber Lime">🟢</button>

        <button class="fw-item theme-btn" data-theme="pastelsky" title="Pastel Sky">☁️</button>
        <button class="fw-item theme-btn" data-theme="softpeach" title="Soft Peach">🍑</button>
        <button class="fw-item theme-btn" data-theme="mintcream" title="Mint Cream">🌿</button>
        <button class="fw-item theme-btn" data-theme="cottoncandy" title="Cotton Candy">🍬</button>

        <button class="fw-item theme-btn" data-theme="deepnavy" title="Deep Navy">🔵</button>
        <button class="fw-item theme-btn" data-theme="carbonblack" title="Carbon Black">⚫</button>
        <button class="fw-item theme-btn" data-theme="royalgold" title="Royal Gold">👑</button>
        <button class="fw-item theme-btn" data-theme="nordfrost" title="Nord Frost">❄️</button>
      </div>
    </div>
  </div>
  <!-- End Theme Preset Full-Width Scroll Bar -->

</header>

  
</header>

  


  <main class="container">
    <section class="leftPanel card">
      <div class="timerHeader">
        <select id="modeSelect" class="select">
          <option value="พัก">พัก</option>
          <option value="ทำงาน">ทำงาน</option>
        </select>
        <div class="dailyTargetWrap">เวลารายวัน <input id="dailyTargetInput" type="number" min="0" value="60" /> นาที</div>
      </div>

      <div class="timerCard timer-display">
        <div id="timerLabel" class="status">สถานะ: พร้อม</div>
        <div id="timeLarge" class="time">00:00:00</div>
        <div id="timeInfo" class="info">ไม่มีการจับเวลา</div>
        <div class="daily-progress">
          <div class="daily-progress__meta">วันนี้พักไปแล้ว: <strong id="sumTodayLarge">0</strong> นาที</div>
          <div class="progressWrap"><div id="sumTodayBar" class="progressBar" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%"></div></div>
          <div class="daily-progress__target">เป้ารายวัน: <strong id="dailyTargetLabel">60</strong> นาที</div>
        </div>
      </div>

      
    <!-- START: Timer background controls (NOAH345) -->
    <div class="timer-bg-controls" style="margin-top:12px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
      <label class="btn ghost" style="display:inline-flex;align-items:center;gap:8px;cursor:pointer;">
        เลือกรูปพื้นหลัง
        <input id="bgFileInput" type="file" accept="image/*" style="display:none" data-no-persist="true">
      </label>

      <div style="display:flex;gap:8px;align-items:center;">
        <div class="small">โปร่ง</div>
        <input id="bgOpacity" type="range" min="0" max="1" step="0.01" value="0.35">
      </div>

      <div style="display:flex;gap:8px;align-items:center;">
        <div class="small">เบลอ</div>
        <input id="bgBlur" type="range" min="0" max="12" step="1" value="0">
      </div>

      <div style="margin-left:auto;display:flex;gap:8px;">
        <button id="bgSaveBtn" class="btn primary">บันทึกพื้นหลัง</button>
        <button id="bgResetBtn" class="btn ghost">คืนค่า</button>
      </div>
    </div>
    <!-- END: Timer background controls -->
<div class="actions">
        <button id="startBtn" class="btn primary large">เริ่ม</button>
        <button id="pauseBtn" class="btn alt large">พัก/Resume</button>
        <button id="endBtn" class="btn warn large">จบ</button>
      </div>

      <div class="settingsGrid">
        <label>ตั้งเวลารอบ (นาที)
          <input id="limitMinutes" type="number" min="1" value="30" />
        </label>
        <label>เตือนก่อน (นาที)
          <input id="warnBefore" type="number" min="0" value="5" />
        </label>
        <label>เสียงแจ้งเตือน
          <input id="soundToggle" type="checkbox" checked />
        </label>
      </div>

      <div class="notes">
        <button id="manualToggle" class="btn ghost">เพิ่มบันทึกแบบกำหนดเอง</button>
        <div id="manualForm" class="manual hidden">
          <input id="manualType" placeholder="ประเภท (เช่น พักกลางวัน)" />
          <input id="manualStart" type="datetime-local" />
          <input id="manualEnd" type="datetime-local" />
          <input id="manualNote" placeholder="หมายเหตุ (ไม่บังคับ)" />
          <div class="row">
            <button id="manualSave" class="btn primary">บันทึก</button>
            <button id="manualCancel" class="btn ghost">ยกเลิก</button>
          </div>
        </div>
      </div>
    </section>

    <aside class="rightPanel">
      <div class="card compact">
        <h3>Analytics</h3>
        <canvas id="chartDaily"></canvas>
        <div class="summary small">
วันนี้คงเหลือ: <strong id="sumRemainBarText">0</strong> นาที
          วันนี้: <strong id="sumToday">0</strong> นาที &nbsp;|&nbsp;
          สัปดาห์: <strong id="sumWeek">0</strong> นาที &nbsp;|&nbsp;
          รวม: <strong id="sumAll">0</strong> นาที
        </div>
      </div>

      <div class="card compact">
        <h3>การแจ้งเตือน & Telegram</h3>
        <label>Bot Token: <input id="tgToken" placeholder="123456:ABC" /></label>
        <label>Chat ID: <input id="tgChatId" placeholder="987654321" /></label>
        <label>Proxy URL (optional): <input id="proxyUrl" placeholder="https://your-proxy.example.com/send" /></label>
        <div class="row small">
          <label><input type="checkbox" id="sendStartNotif" checked /> ส่งเมื่ิอเริ่ม</label>
          <label><input type="checkbox" id="sendNearNotif" checked /> ส่งใกล้หมด</label>
          <label><input type="checkbox" id="sendEndNotif" checked /> ส่งเมื่ิอจบ</label>
        </div>
<div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
  <button id="tgSaveBtn" class="btn btn-primary" type="button">บันทึกค่า</button>
  <label style="font-size:13px; color:#ddd; margin:0;">Token: <input id="tgTokenMask" type="checkbox" /> ซ่อนค่า</label>
</div>

        <div class="row">
          <button id="testTg" class="btn primary">ทดสอบส่ง</button>
          <button id="clearTg" class="btn ghost">ล้าง</button>
        </div>
        <div id="tgResult" class="small debug"></div>
      </div>

      <div class="card compact">
        <h3>History</h3>
        <div class="filters">
          <input type="date" id="filterStart" />
          <input type="date" id="filterEnd" />
          <button id="applyFilter" class="btn ghost">กรอง</button>
        </div>
        <div class="logs"><table id="logsTable"><thead><tr><th>ประเภท</th><th>เริ่ม</th><th>จบ</th><th>นาที</th><th>การกระทำ</th></tr></thead><tbody></tbody></table></div>
        <div class="row">
          <button id="exportCsv" class="btn ghost">Export CSV</button>
          <button id="clearAll" class="btn danger">ลบทั้งหมด</button>
        </div>
      </div>

      <div class="card compact small">
        <div>โฮสต์ออนไลน์: น้องแนบ proxy Node.js ให้พร้อมใช้งาน (ดู README)</div>
        <div class="small">แนะนำ: เปิดใน server (localhost) เพื่อให้ Notification และ Telegram ทำงานถูกต้อง</div>
      </div>
    </aside>
  </main>

  <footer class="footer small">NOAH345 💜 — V11 PRO • อัปเดต UI และเตรียมให้โฮสต์ออนไลน์ได้</footer>

<script src="app.js"></script>

<!-- Edit/Delete Modal (injected by assistant) -->
<div id="editModal" style="display:none;position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;z-index:9999;">
 <div style="background:var(--bg-card);padding:20px;border-radius:10px;min-width:320px;color:var(--text-primary);">
   <h3>แก้ไขรายการ</h3>
   <form id="editForm">
     <input type="hidden" id="editIndex">
     <label>ประเภท <input id="editType"></label>
     <label>เริ่ม <input id="editStart" type="datetime-local"></label>
     <label>จบ <input id="editEnd" type="datetime-local"></label>
     <label>หมายเหตุ <input id="editNote"></label>
     <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:10px;">
       <button type="button" id="editCancel" class="btn ghost">ยกเลิก</button>
       <button type="submit" class="btn primary">บันทึก</button>
     </div>
   </form>
 </div>
</div>


<!-- Edit/Delete History Modal -->
<div id="historyEditModal" style="display:none;position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6);align-items:center;justify-content:center;z-index:10000;">
  <div style="background:var(--bg-card);padding:18px;border-radius:10px;min-width:320px;max-width:680px;color:var(--text-primary);">
    <h3 style="margin-top:0;">แก้ไขรายการบันทึก</h3>
    <div style="display:flex;flex-direction:column;gap:8px;">
      <label>ประเภท<br/><input id="edit_type" type="text" style="width:100%;padding:8px;border-radius:6px;border:1px solid #ddd;" /></label>
      <label>เริ่ม (ISO)<br/><input id="edit_start" type="datetime-local" style="width:100%;padding:8px;border-radius:6px;border:1px solid #ddd;" /></label>
      <label>จบ (ISO)<br/><input id="edit_end" type="datetime-local" style="width:100%;padding:8px;border-radius:6px;border:1px solid #ddd;" /></label>
      <label>หมายเหตุ<br/><input id="edit_note" type="text" style="width:100%;padding:8px;border-radius:6px;border:1px solid #ddd;" /></label>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:6px;">
        <button id="edit_save" class="btn primary">บันทึก</button>
        <button id="edit_delete" class="btn danger">ลบ</button>
        <button id="edit_cancel" class="btn ghost">ยกเลิก</button>
      </div>
    </div>
  </div>
</div>

</body>
</html>

<!-- added theme buttons -->

        <button class="compact-circle theme-btn" data-theme="purple" role="listitem" title="Purple"><span class="icon">💜</span><span class="circle-label">PURPLE</span></button>
        <button class="compact-circle theme-btn" data-theme="cyan" role="listitem" title="Cyan"><span class="icon">💠</span><span class="circle-label">CYAN</span></button>
        <button class="compact-circle theme-btn" data-theme="pink" role="listitem" title="Pink"><span class="icon">🌸</span><span class="circle-label">PINK</span></button>
        <button class="compact-circle theme-btn" data-theme="pastel" role="listitem" title="Pastel"><span class="icon">🫧</span><span class="circle-label">PASTEL</span></button>

        <button class="compact-circle theme-btn" data-theme="violetpulse" role="listitem" title="Violet Pulse"><span class="icon">💜</span><span class="circle-label">VIOLET</span></button>
        <button class="compact-circle theme-btn" data-theme="aquawave" role="listitem" title="Aqua Wave"><span class="icon">💠</span><span class="circle-label">AQUA</span></button>
        <button class="compact-circle theme-btn" data-theme="pinksonic" role="listitem" title="Pink Sonic"><span class="icon">🌸</span><span class="circle-label">PSONIC</span></button>
        <button class="compact-circle theme-btn" data-theme="cyberlime" role="listitem" title="Cyber Lime"><span class="icon">🟢</span><span class="circle-label">LIME</span></button>

        <button class="compact-circle theme-btn" data-theme="pastelsky" role="listitem" title="Pastel Sky"><span class="icon">☁️</span><span class="circle-label">SKY</span></button>
        <button class="compact-circle theme-btn" data-theme="softpeach" role="listitem" title="Soft Peach"><span class="icon">🍑</span><span class="circle-label">PEACH</span></button>
        <button class="compact-circle theme-btn" data-theme="mintcream" role="listitem" title="Mint Cream"><span class="icon">🌿</span><span class="circle-label">MINT</span></button>
        <button class="compact-circle theme-btn" data-theme="cottoncandy" role="listitem" title="Cotton Candy"><span class="icon">🍬</span><span class="circle-label">CANDY</span></button>

        <button class="compact-circle theme-btn" data-theme="deepnavy" role="listitem" title="Deep Navy"><span class="icon">🔵</span><span class="circle-label">NAVY</span></button>
        <button class="compact-circle theme-btn" data-theme="carbonblack" role="listitem" title="Carbon Black"><span class="icon">⚫</span><span class="circle-label">CARBON</span></button>
        <button class="compact-circle theme-btn" data-theme="royalgold" role="listitem" title="Royal Gold"><span class="icon">👑</span><span class="circle-label">GOLD</span></button>
        <button class="compact-circle theme-btn" data-theme="nordfrost" role="listitem" title="Nord Frost"><span class="icon">❄️</span><span class="circle-label">FROST</span></button>
